<PlugResume@Popup>:
    size_hint: 0.5, 0.5
    title: "Plugs resume"
    BoxLayout:
        orientation: "vertical"
        GridLayout:
            cols: 2
            Label:
                text: "Pair of plugs:"
            Label:
                text: "Number of plugs in screen:"
            Label:
                text: str(app.root.get_screen("plugboard_screen").pairs_of_plugs)
            Label:
                text: str(app.root.get_screen("plugboard_screen").plugs_in_screen)
        BoxLayout:
            size_hint: 0.3, 0.3
            pos_hint: {"center_x": 0.5}
            Button:
                text: "Close"
                on_release: root.dismiss()

<Plug@DragBehavior+Image>:
    # TODO: Apparently the widget size interferes with the plug behavior.
    plugged_in: ""
    drag_rectangle: self.x, self.y, self.width, self.height
    drag_timeout: 10000000
    drag_distance: 0
    size_hint: 0.1, 0.1
    source: "misc/plug.png"
    on_touch_up: app.root.get_screen("plugboard_screen").handle_touch_up(*args)
    on_plugged_in: app.root.get_screen("plugboard_screen").on_plugged_in(*args)

<PlugHole@ButtonBehavior+Image>:
    source: "misc/ports.png"
    pos_hint: {'center_x': 0.5, 'center_y': 0.5}
    on_release: app.root.get_screen("plugboard_screen").plug_handler()

<PlugBoard@GridLayout>:
    padding: dp(30)
    canvas:
        Color:
            rgba: 101 / 255, 67 / 255, 33 / 255, 1
        RoundedRectangle:
            pos: self.pos
            size: self.size
    pos_hint: {"center_x": 0.5, "center_y": 0.5}
    cols: 17
    orientation: 'vertical'
    size_hint: 0.9, 0.8
    FloatLayout:
        pos_hint: {'center_x': 0.5, 'center_y': 0.5}
        PlugHole:
            name: "Q"
        Label:
            text: "Q"
            pos_hint: {'center_x': 0.5, 'center_y': 0.5}
    Widget:
    FloatLayout:
        pos_hint: {'center_x': 0.5, 'center_y': 0.5}
        PlugHole:
            name: "W"
        Label:
            text: "W"
            pos_hint: {'center_x': 0.5, 'center_y': 0.5}
    Widget:
    FloatLayout:
        pos_hint: {'center_x': 0.5, 'center_y': 0.5}
        PlugHole:
            name: "E"
        Label:
            text: "E"
            pos_hint: {'center_x': 0.5, 'center_y': 0.5}
    Widget:
    FloatLayout:
        pos_hint: {'center_x': 0.5, 'center_y': 0.5}
        PlugHole:
            name: "R"
        Label:
            text: "R"
            pos_hint: {'center_x': 0.5, 'center_y': 0.5}
    Widget:
    FloatLayout:
        pos_hint: {'center_x': 0.5, 'center_y': 0.5}
        PlugHole:
            name: "T"
        Label:
            text: "T"
            pos_hint: {'center_x': 0.5, 'center_y': 0.5}
    Widget:
    FloatLayout:
        pos_hint: {'center_x': 0.5, 'center_y': 0.5}
        PlugHole:
            name: "Z"
        Label:
            text: "Z"
            pos_hint: {'center_x': 0.5, 'center_y': 0.5}
    Widget:
    FloatLayout:
        pos_hint: {'center_x': 0.5, 'center_y': 0.5}
        PlugHole:
            name: "U"
        Label:
            text: "U"
            pos_hint: {'center_x': 0.5, 'center_y': 0.5}
    Widget:
    FloatLayout:
        pos_hint: {'center_x': 0.5, 'center_y': 0.5}
        PlugHole:
            name: "I"
        Label:
            text: "I"
            pos_hint: {'center_x': 0.5, 'center_y': 0.5}
    Widget:
    FloatLayout:
        pos_hint: {'center_x': 0.5, 'center_y': 0.5}
        PlugHole:
            name: "O"
        Label:
            text: "O"
            pos_hint: {'center_x': 0.5, 'center_y': 0.5}
    Widget:
    FloatLayout:
        pos_hint: {'center_x': 0.5, 'center_y': 0.5}
        PlugHole:
            name: "A"
        Label:
            text: "A"
            pos_hint: {'center_x': 0.5, 'center_y': 0.5}
    Widget:
    FloatLayout:
        pos_hint: {'center_x': 0.5, 'center_y': 0.5}
        PlugHole:
            name: "S"
        Label:
            text: "S"
            pos_hint: {'center_x': 0.5, 'center_y': 0.5}
    Widget:
    FloatLayout:
        pos_hint: {'center_x': 0.5, 'center_y': 0.5}
        PlugHole:
            name: "D"
        Label:
            text: "D"
            pos_hint: {'center_x': 0.5, 'center_y': 0.5}
    Widget:
    FloatLayout:
        pos_hint: {'center_x': 0.5, 'center_y': 0.5}
        PlugHole:
            name: "F"
        Label:
            text: "F"
            pos_hint: {'center_x': 0.5, 'center_y': 0.5}
    Widget:
    FloatLayout:
        pos_hint: {'center_x': 0.5, 'center_y': 0.5}
        PlugHole:
            name: "G"
        Label:
            text: "G"
            pos_hint: {'center_x': 0.5, 'center_y': 0.5}
    Widget:
    FloatLayout:
        pos_hint: {'center_x': 0.5, 'center_y': 0.5}
        PlugHole:
            name: "H"
        Label:
            text: "H"
            pos_hint: {'center_x': 0.5, 'center_y': 0.5}
    Widget:
    FloatLayout:
        pos_hint: {'center_x': 0.5, 'center_y': 0.5}
        PlugHole:
            name: "J"
        Label:
            text: "J"
            pos_hint: {'center_x': 0.5, 'center_y': 0.5}
    Widget:
    FloatLayout:
        pos_hint: {'center_x': 0.5, 'center_y': 0.5}
        PlugHole:
            name: "K"
        Label:
            text: "K"
            pos_hint: {'center_x': 0.5, 'center_y': 0.5}
    Widget:
    FloatLayout:
        pos_hint: {'center_x': 0.5, 'center_y': 0.5}
        PlugHole:
            name: "P"
        Label:
            text: "P"
            pos_hint: {'center_x': 0.5, 'center_y': 0.5}
    Widget:
    FloatLayout:
        pos_hint: {'center_x': 0.5, 'center_y': 0.5}
        PlugHole:
            name: "Y"
        Label:
            text: "Y"
            pos_hint: {'center_x': 0.5, 'center_y': 0.5}
    Widget:
    FloatLayout:
        pos_hint: {'center_x': 0.5, 'center_y': 0.5}
        PlugHole:
            name: "X"
        Label:
            text: "X"
            pos_hint: {'center_x': 0.5, 'center_y': 0.5}
    Widget:
    FloatLayout:
        pos_hint: {'center_x': 0.5, 'center_y': 0.5}
        PlugHole:
            name: "C"
        Label:
            text: "C"
            pos_hint: {'center_x': 0.5, 'center_y': 0.5}
    Widget:
    FloatLayout:
        pos_hint: {'center_x': 0.5, 'center_y': 0.5}
        PlugHole:
            name: "V"
        Label:
            text: "V"
            pos_hint: {'center_x': 0.5, 'center_y': 0.5}
    Widget:
    FloatLayout:
        pos_hint: {'center_x': 0.5, 'center_y': 0.5}
        PlugHole:
            name: "B"
        Label:
            text: "B"
            pos_hint: {'center_x': 0.5, 'center_y': 0.5}
    Widget:
    FloatLayout:
        pos_hint: {'center_x': 0.5, 'center_y': 0.5}
        PlugHole:
            name: "N"
        Label:
            text: "N"
            pos_hint: {'center_x': 0.5, 'center_y': 0.5}
    Widget:
    FloatLayout:
        pos_hint: {'center_x': 0.5, 'center_y': 0.5}
        PlugHole:
            name: "M"
        Label:
            text: "M"
            pos_hint: {'center_x': 0.5, 'center_y': 0.5}
    Widget:
    FloatLayout:
        pos_hint: {'center_x': 0.5, 'center_y': 0.5}
        PlugHole:
            name: "L"
        Label:
            text: "L"
            pos_hint: {'center_x': 0.5, 'center_y': 0.5}

<PlugboardScreen>
    name: "plugboard_screen"
    FloatLayout:
        id: floating_widgets
        get_a_plug: get_a_plug
        AnchorLayout:
            anchor_x: "left"
            anchor_y: "top"
            BoxLayout:
                size_hint_y: 0.1
                Button:
                    size_hint_x: 0.5
                    text: "Go back!"
                    on_release: root.manager.current = "game_screen"
                Button:
                    text: "Get a plug"
                    id: get_a_plug
                    on_release: root.get_plug()
                Button:
                    text: "Plug resume"
                    on_release: Factory.PlugResume().open()
                Label:
                    id: remove_plug
                    text: ""

        AnchorLayout:
            padding: dp(30)
            PlugBoard:
                size_hint: 0.7, 0.7
                id: plug_board
