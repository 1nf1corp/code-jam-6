#:kivy 1.11.1

<MainScreen>:
    BoxLayout:
        orientation: 'vertical'
        TopMenu:
        Abacus:
        BoxLayout:
            orientation: 'horizontal'
            Ledger:
            OperationsBar:
            CuneiformDrawingInput:
                TopRightButton:

<TopMenu>:
    size_hint_y: None
    height: 32
    canvas:
        Color:
            rgb: 1, 0, 0
        Rectangle:
            size: self.size
            pos: self.pos

<Abacus>:
    canvas.before:
        Color:
            rgb: 0.4, 0.4, 0.4, 1
        Rectangle:
            source: 'assets/graphics/wood.png'
            size: self.size
            pos: self.pos

<LedgerRow@GridLayout>:
    cols: 4
    rows: 1
    canvas.before:
        Color:
            rgba: 0.8, 0.8, 0.8, .3
        Rectangle:
            size: self.size
            pos: self.pos
    value: ['x', 'y', 'op', 'z']
    Label:
        text: root.value[0]
    Label:
        text: root.value[1]
    Label:
        text: root.value[2]
    Label:
        text: root.value[3]

<Ledger>:
    size_hint_x: 1.8
    canvas:
        Color:
            rgba: 1, 1, 1, 1
        Rectangle:
            size: self.size
            pos: self.pos
            source: 'assets/graphics/sandstone.jpg'
    rv: rv
    orientation: 'vertical'
    BoxLayout:
        size_hint_y: None
        height: dp(36)
        padding: dp(8)
        spacing: dp(8)
    RecycleView:
        id: rv
        scroll_type: ['bars', 'content']
        scroll_wheel_distance: dp(114)
        bar_width: dp(10)
        viewclass: 'LedgerRow'
        RecycleBoxLayout:
            default_size: None, dp(56)
            default_size_hint: 1, None
            size_hint_y: None
            height: self.minimum_height
            orientation: 'vertical'
            spacing: dp(2)

<OperationsBar>:
    size_hint_x: None
    width: 48
    BoxLayout:
        orientation: 'vertical'
        pos: self.parent.pos
        size: self.parent.size
        Button:
            pos_hint: {'x': 0, 'top': 1}
            Image:
                pos: self.parent.pos
                size: self.parent.size
                allow_stretch: True
                source: self.parent.parent.parent.buttonImage('plus')
        Button:
            pos_hint:  {'x': 0, 'top':4/5}
            Image:
                pos: self.parent.pos
                size: self.parent.size
                allow_stretch: True
                source: self.parent.parent.parent.buttonImage('minus')
        Button:
            pos_hint: {'x': 0, 'top': 3/5}
            Image:
                pos: self.parent.pos
                size: self.parent.size
                allow_stretch: True
                source: self.parent.parent.parent.buttonImage('times')
        Button:
            pos_hint: {'x': 0, 'top': 2/5}
            Image:
                pos: self.parent.pos
                size: self.parent.size
                allow_stretch: True
                source: self.parent.parent.parent.buttonImage('divide')
        Button:
            pos_hint: {'x': 0, 'top': 1/5}
            Image:
                pos: self.parent.pos
                size: self.parent.size
                allow_stretch: True
                source: self.parent.parent.parent.buttonImage('sqrt')


<CuneiformDrawingInput>:
    canvas.before:
        Color:
            rgb: 1, 1, 1, 1
        Rectangle:
            source: 'assets/graphics/sandbox.jpg'
            size: self.size
            pos: self.pos

<TopRightButton>:
    size_hint: 50, 50
    #:set offset 10
    Button:
        size: self.parent.size_hint
        background_color: .5, .5, .5, 1
        x: self.parent.parent.x + self.parent.parent.size[0] - self.size[0] - offset
        y: self.parent.parent.y + self.parent.parent.size[1] - self.size[1] - offset
        on_press:
            self.background_color = 0, 0, 0.055
            self.parent.parent.click()
        on_release:
            self.background_color = .5, .5, .5, 1
        canvas.before:
            Color:
                rgba: self.background_color
            Line:
                width: 2
                rectangle: self.x, self.y, self.width, self.height
        Image:
            source: self.parent.parent.parent.buttonImage()
            center_x: self.parent.center_x
            center_y: self.parent.center_y
            allow_stretch: True
            size: self.parent.size
